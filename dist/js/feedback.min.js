angular.module("MyApp",[]).controller("UploadCtrl",["$scope","$http",function(e,a){e.feedback={formVissible:!1,messageSent:!1,name:"",email:"",message:"",file:"",errors:{message:!1}},e.toggleForm=function(a){e.feedback.formVissible=a;var n=angular.element(document.querySelector("form#notification"));1==e.feedback.formVissible?n.removeClass("hidden"):n.addClass("hidden"),1==e.feedback.messageSent&&(e.feedback.messageSent=!1)},e.submit=function(){if(0==e.feedback.message.length)return e.feedback.errors.message="Treść zgłoszenia nie może być pusta.",!1;e.feedback.errors.message=!1,0==e.feedback.name.length&&(e.feedback.name="Rysiek Anonim"),0==e.feedback.email.length&&(e.feedback.email="kontakt@podlasiesiedziej.pl");var n=new FormData;n.append("sendFeedbackForm[attachment]",e.feedback.file),n.append("sendFeedbackForm[first_name]",e.feedback.name),n.append("sendFeedbackForm[last_name]","..."),n.append("sendFeedbackForm[email]",e.feedback.email),n.append("sendFeedbackForm[subject]","Zgłoszenie od czytelnika."),n.append("sendFeedbackForm[message]",e.feedback.message),n.append("publication",newscoop.feedbackPlugin.publication),n.append("feedbackUrl",newscoop.feedbackPlugin.feedbackUrl),a.post("http://newscoop.dev/plugin/send-feedback",n,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a){e.toggleForm(!1),e.feedback.messageSent=!0,e.feedback.file=null,e.feedback.message=null}).error(function(e){console.log(e)})}}]),angular.module("MyApp").directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(a,n,s){var d=e(s.fileModel),o=d.assign;n.bind("change",function(){a.$apply(function(){o(a,n[0].files[0])})})}}}]),angular.module("MyApp").config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]);